<?php

namespace Evolution\Kernel;

/**
 * Visual theme for system pages
 */
class Page {
	
	public $title = '';
	
	public $type = 'root';
	
	public $value = '';
	
	private $children = array();
	
	/**
	 * Add any subtypes
	 */
	public function __call($method, $args) {
		
		// Create subpage
		$child = new Page();
		$child->type = $method;
		$child->value = array_shift($args);
		
		// Add to children
		$this->children[] = $child;
		
		return $child;
	}
	
	public function render($depth = 0) {
		
		// Check for undefined types
		if(strpos($this->type, 'Header') !== false) {
			die('Evolution\Kernel\Page: '. $this->type . ' not defined!');
		}
		
		// Header function
		$header = $this->type . 'Header';
		$this->$header();
		
		// Loop through children
		foreach($this->children as $child)
			$child->render($depth + 1);
		
		// Footer function
		$footer = $this->type . 'Footer';
		$this->$footer();
	
	}
	
	public function sectionHeader() { echo "<div class='section'><h1>$this->value</h1>"; }
	public function sectionFooter() { echo "</div>"; }
	
	public function tableHeader() { echo "<table>"; }
	public function tableFooter() { echo "</table>"; }
	
	public function rowHeader() { echo "<tr class=\"$this->value\">"; }
	public function rowFooter() { echo "</tr>"; }
	
	public function cellHeader() { echo "<td class=\"$this->value\">"; }
	public function cellFooter() { echo "</td>"; }
	
	public function paragraphHeader() {echo "<p>$this->value</p>";}
	public function paragraphFooter() {}
	
	public function rootHeader() { echo <<<EOF
<!doctype html>

<!-- Generated by Evolution\Kernel\Page -->
<html>
	<head>
		<title>$this->title</title>
		<style>
			body {
				font-size: 20px;
				font-family: Tahoma, Sans, Lucida Grande, sans-serif;
			}
			.section {
				font-size: 90%;	
			}
			h1 {
				font-size: 120%;
				margin: 0.5em 0;
			}
		</style>
	</head>
	
	<body>
EOF;
	}
	
	public function rootFooter() { echo <<<EOF
	</body>
</html>
EOF;
	}
}